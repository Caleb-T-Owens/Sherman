---
// Font selector component
---

<fieldset class="font-size-selector">
  <legend>Font size</legend>
  <div>
    <input
      type="radio"
      name="font-size"
      id="font-small"
      value="small"
    />
    <label for="font-small">Small</label>
  </div>
  <div>
    <input
      type="radio"
      name="font-size"
      id="font-medium"
      value="medium"
      checked
    />
    <label for="font-medium">Medium</label>
  </div>
  <div>
    <input
      type="radio"
      name="font-size"
      id="font-large"
      value="large"
    />
    <label for="font-large">Large</label>
  </div>
</fieldset>

<style>
  .font-size-selector {
    width: fit-content;
    margin-bottom: 1rem;
  }

  .font-size-selector > div {
    display: inline-flex;
    align-items: center;
    margin-right: 1rem;
  }

  .font-size-selector > div:last-child {
    margin-right: 0.5rem;
  }
</style>

<script>
  // Initialize font size from localStorage
  function initializeFontSize() {
    const initialFontSize = localStorage.getItem('selected-font-size') || 'medium';
    updateHtmlStyles(initialFontSize);
  }

  // Update HTML styles based on selected font size
  function updateHtmlStyles(size: string) {
    localStorage.setItem('selected-font-size', size);

    const html = document.querySelector('html')!;
    html.classList.remove('font-small', 'font-medium', 'font-large');
    html.classList.add(`font-${size}`);

    // Update radio buttons
    const radios = document.querySelectorAll('input[name="font-size"]') as NodeListOf<HTMLInputElement>;
    radios.forEach(radio => {
      radio.checked = radio.value === size;
    });
  }

  // Set up event listeners
  function setupEventListeners() {
    const radios = document.querySelectorAll('input[name="font-size"]');
    radios.forEach(radio => {
      radio.addEventListener('change', (event) => {
        const value = (event.target as HTMLInputElement).value;
        updateHtmlStyles(value);
      });
    });
  }

  // Initialize on page load
  if (typeof window !== 'undefined') {
    initializeFontSize();
    setupEventListeners();
  }

  // Re-initialize on navigation (for Astro view transitions)
  document.addEventListener('astro:page-load', () => {
    initializeFontSize();
    setupEventListeners();
  });
</script>
